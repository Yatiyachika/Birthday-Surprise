<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Happy Birthday Priyaranjan ‚Äî from Ashi</title>
<style>
  html,body{margin:0;height:100%;overflow:hidden;background:#0b1530;font-family: 'Poppins', system-ui, -apple-system, Segoe UI, Roboto, Arial}
  #c{display:block;width:100vw;height:100vh}
  .hud{
    position:fixed;left:0;right:0;bottom:28px;
    display:flex;flex-direction:column;align-items:center;gap:10px;
    color:#e8ecff;text-align:center;pointer-events:none;
  }
  .since{font-size:14px;letter-spacing:.12em;opacity:.85}
  .timer{font-size:18px; font-weight:600}
  .msg{
    position:fixed;left:0;right:0;top:10vh;text-align:center;
    color:#ffeef8;font-weight:400;font-size:clamp(20px,4vw,44px);
    text-shadow:0 0 10px #ff6ec7, 0 0 25px #ff6ec7;
    opacity:0;transition:opacity 1.2s ease;
    pointer-events:none;
  }
  .msg.show{opacity:1}
  .clickhint{
    position:fixed;left:50%;top:48%;transform:translate(-50%,-50%);
    color:#ffd6e8;font-weight:600;letter-spacing:.08em;font-size:clamp(14px,2.4vw,20px);
    text-shadow:0 2px 4px rgba(0,0,0,.35);animation:hint 1.2s ease-in-out infinite;
    user-select:none;pointer-events:none;
  }
  @keyframes hint {0%,100%{transform:translate(-50%,-50%) scale(1)}50%{transform:translate(-50%,-50%) scale(1.06)}}
</style>
</head>
<body>
<canvas id="c"></canvas>

<div class="msg" id="title">Our Love is similar to this tree‚ù§Ô∏è<br/>It starts from a one heart and become a big Tree of hearts.üíï<br/>I spent my best 4 years with you üå∏<br>I've spent with you is my favorite memory.</div>

<div class="hud">
  <div class="since">THE WORLD JUST GOT LUCKIER SINCE</div>
  <div class="timer" id="timer">Days 0  Hours 0  Minutes 0</div>
</div>

<div class="clickhint" id="hint">Click the heart</div>

<script>
/* ===================== USER SETTINGS ===================== */
/* Change this to your real ‚Äúmet/birth‚Äù date for the counter */
const SINCE_DATE = new Date('2004-09-15T00:00:00'); // <- edit me
/* ========================================================= */

const canvas = document.getElementById('c');
const ctx = canvas.getContext('2d');
let W = canvas.width = innerWidth;
let H = canvas.height = innerHeight;

addEventListener('resize', () => { W = canvas.width = innerWidth; H = canvas.height = innerHeight; initScene(); });

/* ------- utilities ------- */
const rand = (a,b)=>a+Math.random()*(b-a);
const TAU = Math.PI*2;

/* ------- background: stars, moon, balloons ------- */
let stars=[], balloons=[];
function makeStars(){
  stars = Array.from({length:120}, ()=>({
    x: Math.random()*W,
    y: Math.random()*H,
    r: Math.random()*1.6+0.3,
    tw: Math.random()*TAU
  }));
}
function drawStars(t){
  for(const s of stars){
    s.tw += 0.02;
    const a = 0.4+Math.sin(s.tw)*0.4;
    ctx.globalAlpha = a;
    ctx.fillStyle='#bcd3ff';
    ctx.beginPath(); ctx.arc(s.x,s.y,s.r,0,TAU); ctx.fill();
  }
  ctx.globalAlpha=1;
}
function drawMoon(){
  const r = Math.min(W,H)*0.08;
  const x = W*0.18, y = H*0.18;
  ctx.fillStyle='#fff7de';
  ctx.beginPath(); ctx.arc(x,y,r,0,TAU); ctx.fill();
  ctx.globalCompositeOperation='destination-out';
  ctx.beginPath(); ctx.arc(x+r*0.45,y-r*0.15,r*0.9,0,TAU); ctx.fill();
  ctx.globalCompositeOperation='source-over';
}
function makeBalloons(){
  const colors = ['#ff6b6b','#ffd166','#4cc9f0','#95f9a3','#ff9de6'];
  balloons = Array.from({length:6},(_,i)=>({
    x: rand(0.05*W,0.95*W),
    y: rand(H, H*1.8),
    vy: rand(0.15,0.45),
    sway: rand(20,45),
    phase: Math.random()*TAU,
    col: colors[i%colors.length]
  }));
}
function drawBalloons(t){
  for(const b of balloons){
    b.y -= b.vy;
    b.phase += 0.01;
    const xx = b.x + Math.sin(b.phase)*b.sway;

    // body
    const grad = ctx.createRadialGradient(xx-12,b.y-16,3, xx,b.y,40);
    grad.addColorStop(0,'#ffffff'); grad.addColorStop(1,b.col);
    ctx.fillStyle = grad;
    ctx.beginPath();
    ctx.ellipse(xx,b.y,28,38,0,0,TAU); ctx.fill();

    // knot
    ctx.fillStyle = b.col;
    ctx.beginPath();
    ctx.moveTo(xx-6,b.y+34); ctx.lineTo(xx+6,b.y+34); ctx.lineTo(xx,b.y+44); ctx.closePath(); ctx.fill();

    // string
    ctx.strokeStyle='#d9e1ff'; ctx.lineWidth=1.2;
    ctx.beginPath(); ctx.moveTo(xx,b.y+44);
    for(let y=0;y<70;y+=10){
      ctx.lineTo(xx + Math.sin(b.phase+y*0.2)*6, b.y+44+y);
    }
    ctx.stroke();

    if(b.y < -120){ b.y = rand(H, H*1.6); b.x = rand(0.1*W,0.9*W); }
  }
}

/* ------- heart shape draw ------- */
function drawHeart(x,y,size,fill,alpha=1,rot=0){
  ctx.save();
  ctx.translate(x,y);
  ctx.rotate(rot);
  ctx.scale(size,size);
  ctx.globalAlpha = alpha;
  ctx.fillStyle = fill;
  ctx.beginPath();
  ctx.moveTo(0,-0.3);
  ctx.bezierCurveTo(0.5,-0.9, 1.2,-0.1, 0,0.9);
  ctx.bezierCurveTo(-1.2,-0.1, -0.5,-0.9, 0,-0.3);
  ctx.fill();
  ctx.restore();
  ctx.globalAlpha=1;
}

/* ------- trunk (curved, tapered) ------- */
function drawTrunk(progress){ // progress 0..1
  const baseW = Math.min(W,H)*0.06;
  const topW  = baseW*0.38;
  const hMax  = Math.min(W,H)*0.36;
  const h = hMax*progress;
  const x = W*0.62, yBase = H*0.82;

  const grd = ctx.createLinearGradient(0,yBase-h,0,yBase);
  grd.addColorStop(0,'#b16825');
  grd.addColorStop(1,'#7a3f12');

  ctx.fillStyle = grd;
  ctx.beginPath();
  ctx.moveTo(x - baseW/2, yBase);
  ctx.quadraticCurveTo(x - baseW*0.55, yBase - h*0.55, x - topW/2, yBase - h);
  ctx.lineTo(x + topW/2, yBase - h);
  ctx.quadraticCurveTo(x + baseW*0.55, yBase - h*0.55, x + baseW/2, yBase);
  ctx.closePath();
  ctx.shadowColor='rgba(0,0,0,.25)';
  ctx.shadowBlur=16; ctx.shadowOffsetY=6;
  ctx.fill();
  ctx.shadowColor='transparent';
}

/* ------- canopy particle system (heart leaves) ------- */
let leaves=[], leavesTarget=480, leavesSpawned=500, canopyCenter, canopyScale;
const leafColors = ['#ff5d8f','#ff99cc','#ffd166','#ff6b6b','#ffa8a8','#f48fb1'];
function pointInHeart(u,v){
  // implicit heart (x^2 + y^2 -1)^3 - x^2 y^3 <= 0 ; using u,v in [-1.1,1.1]
  const x=u, y=v;
  return Math.pow(x*x + y*y - 1, 3) - x*x*y*y*y <= 0;
}
function spawnLeaf(){
  // pick a random point inside a heart shape
  for(let k=0;k<150;k++){
    const u = rand(-1.1,1.1), v = rand(-1.1,1.1);
    if(pointInHeart(u,v)){
      const size = rand(160,186);
      leaves.push({
        x: canopyCenter.x + u*canopyScale,
        y: canopyCenter.y + v*canopyScale,
        s: size,
        col: leafColors[(Math.random()*leafColors.length)|0],
        a: 0,
        rot: rand(-0.6,0.6),
        sway: rand(0.5,1.2),
        phase: Math.random()*TAU
      });
      leavesSpawned++;
      break;
    }
  }
}
function updateLeaves(){
  for(const L of leaves){
    L.phase += 0.02*L.sway;
    L.a = Math.min(1, L.a + 0.04);                 // fade-in (bloom)
    const dx = Math.sin(L.phase)*2.0;              // gentle wind sway
    drawHeart(L.x+dx, L.y, L.s/28, L.col, L.a, L.rot);
  }
}

/* ------- big clickable heart ------- */
let bigHeart = { x:50, y:60, s:60, vy:100, falling:false, disappeared:false };
function resetBigHeart(){
  bigHeart.x = W*0.62;
  bigHeart.y = H*0.35;
  bigHeart.s = Math.min(W,H)*0.8;
  bigHeart.vy = 0; bigHeart.falling=false; bigHeart.disappeared=false;
}

/* ------- timer ------- */
const timerEl = document.getElementById('timer');
function updateTimer(){
  const now = new Date();
  let diff = Math.max(0, now - SINCE_DATE);
  const mins = Math.floor(diff/60000);
  const hrs  = Math.floor(mins/60);
  const days = Math.floor(hrs/24);
  timerEl.textContent = `Days ${days}  Hours ${hrs%24}  Minutes ${mins%60}`;
}

/* ------- scene state machine ------- */
let state = 'idle'; // idle -> falling -> trunk -> bloom -> done
let trunkProgress = 0;
const title = document.getElementById('title');
const hint = document.getElementById('hint');

function initScene(){
  makeStars(); makeBalloons(); resetBigHeart();
  canopyCenter = { x: W*0.62, y: H*0.42 };
  canopyScale  = Math.min(W,H)*0.16;
  leaves = []; leavesSpawned=0; trunkProgress=0; state='idle';
  title.classList.remove('show');
}

initScene();
updateTimer();
setInterval(updateTimer, 1000);

canvas.addEventListener('click', ()=>{
  if(state==='idle'){ state='falling'; hint.style.display='none'; bigHeart.falling=true; }
});

function loop(){
  ctx.clearRect(0,0,W,H);

  // gradient night sky
  const g = ctx.createLinearGradient(0,0,0,H);
  g.addColorStop(0,'#0b1530'); g.addColorStop(1,'#0e2150');
  ctx.fillStyle = g; ctx.fillRect(0,0,W,H);

  drawStars();
  drawMoon();
  drawBalloons();

  // big heart sequence
  if(!bigHeart.disappeared){
    if(bigHeart.falling){
      bigHeart.vy += 0.4; // gravity
      bigHeart.y += bigHeart.vy;
      if(bigHeart.y > H*0.8){ // impact
        bigHeart.disappeared = true;
        state='trunk';
      }
    }
    drawHeart(bigHeart.x, bigHeart.y, bigHeart.s/28, '#ff648c', 1, Math.sin(performance.now()*0.003)*0.12);
  }

  // trunk grow
  if(state==='trunk' || state==='bloom' || state==='done'){
    trunkProgress = Math.min(1, trunkProgress + 0.015);
    drawTrunk(trunkProgress);
    if(trunkProgress>=1 && state==='trunk'){ state='bloom'; }
  }

  // spawn & draw leaves
  if(state==='bloom'){
    // spawn a few per frame until target reached
    for(let i=0;i<6;i++){ if(leavesSpawned<leavesTarget) spawnLeaf(); }
    updateLeaves();
    if(leavesSpawned>=leavesTarget && leaves.every(l=>l.a>=0.99)){
      state='done'; setTimeout(()=>title.classList.add('show'), 400);
    }
  } else if(state==='done'){
    updateLeaves();
  }

  requestAnimationFrame(loop);
}
loop();
</script>
<script>
  // 10 second baad puzzle page open ho jayega
  setTimeout(() => {
    window.location.href = "puzzle.html";
  }, 10000);
</script>

</body>
</html>
